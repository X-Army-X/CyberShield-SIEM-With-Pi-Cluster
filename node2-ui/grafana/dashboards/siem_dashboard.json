{
  "__inputs": [
    {
      "name": "DS_LOGS",
      "label": "Logs",
      "description": "",
      "type": "datasource",
      "pluginId": "influxdb",
      "pluginName": "InfluxDB"
    }
  ],
  "__elements": {},
  "__requires": [
    {
      "type": "panel",
      "id": "barchart",
      "name": "Bar chart",
      "version": ""
    },
    {
      "type": "panel",
      "id": "gauge",
      "name": "Gauge",
      "version": ""
    },
    {
      "type": "grafana",
      "id": "grafana",
      "name": "Grafana",
      "version": "12.3.0"
    },
    {
      "type": "datasource",
      "id": "influxdb",
      "name": "InfluxDB",
      "version": "1.0.0"
    },
    {
      "type": "panel",
      "id": "table",
      "name": "Table",
      "version": ""
    },
    {
      "type": "panel",
      "id": "text",
      "name": "Text",
      "version": ""
    },
    {
      "type": "panel",
      "id": "timeseries",
      "name": "Time series",
      "version": ""
    }
  ],
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 1,
          "mappings": [],
          "max": 100,
          "min": 0,
          "noValue": "Oopsâ— Something Is Wrong ðŸ˜Ÿ",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "#EAB839",
                "value": 60
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 7,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 11,
      "options": {
        "minVizHeight": 75,
        "minVizWidth": 75,
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "last"
          ],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true,
        "sizing": "auto"
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "hide": false,
          "query": "// SYSTEM HEALTH (One query -> one frame -> multiple named gauge fields)\r\n\r\n// ---- CPU (usage_active already equals CPU usage %) ----\r\ncpu =\r\n  from(bucket: \"Security_logs\")\r\n    |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n    |> filter(fn: (r) =>\r\n      r._measurement == \"cpu\" and\r\n      r._field == \"usage_active\" and\r\n      r.cpu == \"cpu-total\"\r\n    )\r\n    |> last()\r\n    |> keep(columns: [\"host\", \"_value\"])\r\n    |> map(fn: (r) => ({\r\n      _time: now(),\r\n      _field: r.host + \" â€“ CPU (%)\",\r\n      _value: float(v: r._value)\r\n    }))\r\n\r\n// ---- Memory (used_percent) ----\r\nmem =\r\n  from(bucket: \"Security_logs\")\r\n    |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n    |> filter(fn: (r) =>\r\n      r._measurement == \"mem\" and\r\n      r._field == \"used_percent\"\r\n    )\r\n    |> last()\r\n    |> keep(columns: [\"host\", \"_value\"])\r\n    |> map(fn: (r) => ({\r\n      _time: now(),\r\n      _field: r.host + \" â€“ Memory (%)\",\r\n      _value: float(v: r._value)\r\n    }))\r\n\r\nunion(tables: [cpu, mem])\r\n  |> group() // force single frame\r\n  |> pivot(rowKey: [\"_time\"], columnKey: [\"_field\"], valueColumn: \"_value\")\r\n  |> sort(columns: [\"_time\"], desc: true)\r\n  |> limit(n: 1)\r\n",
          "refId": "A"
        }
      ],
      "title": "System Health & Resource Utilization",
      "transparent": true,
      "type": "gauge"
    },
    {
      "description": "This panel is an intended post-deployment analytics expansion of the Cyber-Shield platform.\nThe ongoing project aims at the trusty information gathering, correlation, and visualization of the IDS, honeypot, and wireless surveillance information.\nHighly complex statistical and machine-learning anomaly detection is intentionally pushed off to another production release once the system is baselined and long-term data is acquired.",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 7
      },
      "id": 10,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "## CyberShield ML Anomaly Detection (Planned â€“ Future Work)\n\n**Status:** Not implemented in this prototype. This panel documents the intended ML layer and integration points.\n\n### Purpose\nIdentify anomalous security behaviour by learning a baseline from normal telemetry, then flagging deviations.\n\n### Intended data sources (already integrated in this dashboard)\n- **Suricata:** alert counts over time, signatures, src/dst distribution, severity\n- **Cowrie:** login failures, session events, username patterns, source IP behaviour\n- **Kismet:** device/AP detection rates, emergence of new devices, cloaked SSIDs (if available)\n\n### Feature engineering (examples)\n- Sliding-window features (e.g., 1m / 5m / 15m):\n  - counts per source IP / destination IP\n  - entropy of signature distribution\n  - severity-weighted alert score\n  - rate of Cowrie authentication failures\n  - rate of new wireless devices / APs\n- Optional correlation features:\n  - Suricata spikes aligned with Cowrie events\n  - wireless spikes aligned with IDS spikes (multi-layer signal)\n\n### Candidate models (unsupervised by default)\n- Isolation Forest\n- One-Class SVM\n- Autoencoder reconstruction error\n- Statistical baselines (EWMA / z-score) as a strong non-ML benchmark\n\n### Output (future)\n- `anomaly_score` time series (0â€“1 or unbounded score)\n- `anomaly_flag` boolean (thresholded)\n- top contributing features (explainability summary)\n\n### Evaluation plan\n- Offline validation using:\n  - injected test scenarios (documented attacks)\n  - precision/recall where labels exist\n  - time-to-detect and false positive rate\n- Operational considerations:\n  - concept drift monitoring and periodic retraining\n  - threshold tuning per environment\n\n**Next integration step:** publish computed `anomaly_score` and `anomaly_flag` into InfluxDB as measurement `ml_anomalies`, then visualize here.\n",
        "mode": "markdown"
      },
      "pluginVersion": "12.3.0",
      "title": "Planned Advanced Analytics (Beyond Project Scope)",
      "type": "text"
    },
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "noValue": "ðŸ¯The Bees are Behaving ðŸ‘®(No Events)",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 7
      },
      "id": 7,
      "options": {
        "legend": {
          "calcs": [
            "last"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "query": "from(bucket: \"Security_logs\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement == \"cowrie_events\")\r\n  |> filter(fn: (r) => r._field == \"count\")\r\n  |> filter(fn: (r) => r.eventid != \"manual_test\")\r\n  |> aggregateWindow(\r\n      every: v.windowPeriod,\r\n      fn: sum,\r\n      createEmpty: false\r\n  )\r\n  |> group()\r\n  |> rename(columns: {_value: \"Cowrie Events\"})\r\n",
          "refId": "A"
        }
      ],
      "title": "Cowrie Event Count Over Time",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "filterable": true,
            "footer": {
              "reducers": []
            },
            "hideFrom": {
              "viz": false
            },
            "inspect": false,
            "wrapHeaderText": false,
            "wrapText": false
          },
          "mappings": [],
          "noValue": "ðŸ¯The Bees are Behaving ðŸ‘®(No Events)",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 169
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Details"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 479
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "protocol"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 93
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Event"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 142
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 15
      },
      "id": 8,
      "options": {
        "cellHeight": "sm",
        "enablePagination": true,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Details"
          }
        ]
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "query": "from(bucket: \"Security_logs\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement == \"cowrie_events\")\r\n  |> filter(fn: (r) => r._field == \"message\")\r\n  |> keep(columns: [\"_time\", \"eventid\", \"src_ip\", \"username\", \"protocol\", \"sensor\", \"_value\"])\r\n  |> rename(columns: {_value: \"message\"})\r\n  |> sort(columns: [\"_time\"], desc: true)\r\n  |> limit(n: 200)\r\n  |> group()\r\n  |> sort(columns: [\"_time\"], desc: true)\r\n  |> limit(n: 30)\r\n\r\n",
          "refId": "A"
        }
      ],
      "title": "Recent Cowrie Session Events",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "message": false,
              "sensor": true,
              "username": true
            },
            "includeByName": {},
            "indexByName": {},
            "orderByMode": "manual",
            "renameByName": {
              "_time": "Time",
              "eventid": "Event",
              "message": "Details",
              "protocol": "protocol",
              "sensor": "",
              "src_ip": "Source IP",
              "username": "Username"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "description": "For more Details please accses Kismet Interface (192.168.100.116:2501)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "displayName": "${__field.labels.type}",
          "mappings": [],
          "noValue": "ðŸ›¡ï¸ All Secure No Alerts (Past 24H)",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "__systemRef": "hideSeriesFrom",
            "matcher": {
              "id": "byNames",
              "options": {
                "mode": "exclude",
                "names": [
                  "device"
                ],
                "prefix": "All except:",
                "readOnly": true
              }
            },
            "properties": [
              {
                "id": "custom.hideFrom",
                "value": {
                  "legend": false,
                  "tooltip": true,
                  "viz": true
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 23
      },
      "id": 9,
      "options": {
        "legend": {
          "calcs": [
            "last",
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "timezone": [
          "browser"
        ],
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "query": "from(bucket: \"Security_logs\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement == \"kismet_events\")\r\n  |> filter(fn: (r) => r._field == \"count\")\r\n  |> group(columns: [\"type\"])\r\n  |> aggregateWindow(every: v.windowPeriod, fn: sum, createEmpty: false)\r\n",
          "refId": "A"
        }
      ],
      "title": "Kismet(Wireless) Event Count Over Time",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "smooth",
            "lineStyle": {
              "fill": "solid"
            },
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "line+area"
            }
          },
          "decimals": 0,
          "mappings": [],
          "noValue": "ðŸ›¡ï¸ All Secure No Alerts (Past 24H)",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 20
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "__systemRef": "hideSeriesFrom",
            "matcher": {
              "id": "byNames",
              "options": {
                "mode": "exclude",
                "names": [
                  "count {dest_ip=\"192.168.100.116\", proto=\"ICMP\", sid=\"1000001\", signature=\"CYBERSHIELD TEST ICMP ALERT\", src_ip=\"192.168.100.115\"}"
                ],
                "prefix": "All except:",
                "readOnly": true
              }
            },
            "properties": [
              {
                "id": "custom.hideFrom",
                "value": {
                  "legend": false,
                  "tooltip": true,
                  "viz": true
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 10,
        "w": 24,
        "x": 0,
        "y": 31
      },
      "id": 1,
      "options": {
        "legend": {
          "calcs": [
            "last",
            "min",
            "max",
            "sum"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "timezone": [
          "browser"
        ],
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "query": "from(bucket: \"Security_logs\")\r\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |> filter(fn: (r) => r._measurement == \"suricata_alerts\")\r\n  |> filter(fn: (r) => r._field == \"count\")\r\n  |> aggregateWindow(every: 1m, fn: sum, createEmpty: false)\r\n  |> yield(name: \"alerts_per_min\")\r\n",
          "refId": "A"
        }
      ],
      "title": "Alert Count Over Time",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMax": 1,
            "axisWidth": -1,
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 0,
          "mappings": [],
          "noValue": "No Activities Running ðŸ¥±ðŸ›¡ï¸",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 11,
        "w": 24,
        "x": 0,
        "y": 41
      },
      "id": 2,
      "options": {
        "barRadius": 0.02,
        "barWidth": 0.9,
        "fullHighlight": false,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "orientation": "vertical",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        },
        "xField": "signature",
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "query": "from(bucket: \"Security_logs\")\r\n  |> range(start: -30m)\r\n  |> filter(fn: (r) => r._measurement == \"suricata_alerts\")\r\n  |> filter(fn: (r) => r._field == \"count\")\r\n  |> group(columns: [\"signature\"])\r\n  |> sum()\r\n  |> group()\r\n  |> keep(columns: [\"signature\", \"_value\"])\r\n  |> rename(columns: {_value: \"alerts\"})\r\n  |> sort(columns: [\"alerts\"], desc: true)\r\n  |> limit(n: 10)\r\n",
          "refId": "A"
        }
      ],
      "title": "Top Signatures",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "alerts": false,
              "signature": false
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "alerts": "",
              "signature": ""
            }
          }
        }
      ],
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 0,
          "mappings": [],
          "noValue": "No Activities Running ðŸ¥±ðŸ›¡ï¸",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 24,
        "x": 0,
        "y": 52
      },
      "id": 6,
      "options": {
        "barRadius": 0.02,
        "barWidth": 0.9,
        "fullHighlight": false,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "hideZeros": true,
          "mode": "single",
          "sort": "none"
        },
        "xField": "severity",
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "query": "from(bucket: \"Security_logs\")\r\n  |> range(start: -30m)\r\n  |> filter(fn: (r) => r._measurement == \"suricata_alerts\")\r\n  |> filter(fn: (r) => r._field == \"severity\")\r\n  |> map(fn: (r) => ({ sev: int(v: r._value), one: 1 }))\r\n  |> group(columns: [\"sev\"])\r\n  |> sum(column: \"one\")\r\n  |> group()\r\n  |> rename(columns: {sev: \"severity\", one: \"alerts\"})\r\n  |> keep(columns: [\"severity\", \"alerts\"])\r\n  |> sort(columns: [\"severity\"])\r\n",
          "refId": "A"
        }
      ],
      "title": "Severity Distribution",
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": true,
            "axisCenteredZero": false,
            "axisColorMode": "series",
            "axisLabel": "",
            "axisPlacement": "auto",
            "fillOpacity": 80,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 0,
          "mappings": [],
          "max": -1,
          "noValue": "No Activities Running ðŸ¥±ðŸ›¡ï¸",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 0,
        "y": 62
      },
      "id": 3,
      "options": {
        "barRadius": 0.02,
        "barWidth": 0.9,
        "fullHighlight": false,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "hideZeros": true,
          "mode": "single",
          "sort": "none"
        },
        "xField": "src_ip",
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "query": "from(bucket: \"Security_logs\")\r\n  |> range(start: -30m)\r\n  |> filter(fn: (r) => r._measurement == \"suricata_alerts\")\r\n  |> filter(fn: (r) => r._field == \"count\")\r\n  |> group(columns: [\"src_ip\"])\r\n  |> sum()\r\n  |> group()\r\n  |> keep(columns: [\"src_ip\", \"_value\"])\r\n  |> rename(columns: {_value: \"alerts\"})\r\n  |> sort(columns: [\"alerts\"], desc: true)\r\n  |> limit(n: 10)\r\n\r\n\r\n\r\n\r\n",
          "refId": "A"
        }
      ],
      "title": "Top Source IPs",
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "fillOpacity": 80,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "type": "linear"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 0,
          "mappings": [],
          "noValue": "No Activities Running ðŸ¥±ðŸ›¡ï¸",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 12,
        "y": 62
      },
      "id": 4,
      "options": {
        "barRadius": 0.02,
        "barWidth": 0.9,
        "fullHighlight": false,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        },
        "xField": "dest_ip",
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "query": "from(bucket: \"Security_logs\")\r\n  |> range(start: -30m)\r\n  |> filter(fn: (r) => r._measurement == \"suricata_alerts\")\r\n  |> filter(fn: (r) => r._field == \"count\")\r\n  |> group(columns: [\"dest_ip\"])\r\n  |> sum()\r\n  |> group()\r\n  |> keep(columns: [\"dest_ip\", \"_value\"])\r\n  |> rename(columns: {_value: \"alerts\"})\r\n  |> sort(columns: [\"alerts\"], desc: true)\r\n  |> limit(n: 10)\r\n",
          "refId": "A"
        }
      ],
      "title": "Top Destination IPs",
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "influxdb",
        "uid": "${DS_LOGS}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "filterable": true,
            "footer": {
              "reducers": []
            },
            "inspect": false,
            "wrapHeaderText": false,
            "wrapText": false
          },
          "mappings": [],
          "noValue": "ðŸ›¡ï¸ All Secure No Recent Alerts (Past 24H)",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Severity"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 101
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 188
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Category"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 306
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Protocal "
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 90
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Signature ID"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 121
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Signature"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 347
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Destination IP"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 153
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 11,
        "w": 24,
        "x": 0,
        "y": 71
      },
      "id": 5,
      "options": {
        "cellHeight": "sm",
        "enablePagination": true,
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "12.3.0",
      "targets": [
        {
          "datasource": {
            "type": "influxdb",
            "uid": "${DS_LOGS}"
          },
          "query": "from(bucket: \"Security_logs\")\r\n  |> range(start: -30m)\r\n  |> filter(fn: (r) => r._measurement == \"suricata_alerts\")\r\n  |> filter(fn: (r) => r._field == \"severity\")\r\n  |> keep(columns: [\"_time\", \"_value\", \"src_ip\", \"dest_ip\", \"proto\", \"sid\", \"signature\", \"category\"])\r\n  |> rename(columns: {_value: \"severity\"})\r\n  |> sort(columns: [\"_time\"], desc: true)\r\n  |> limit(n: 200)\r\n",
          "refId": "A"
        }
      ],
      "title": "Recent Alert Details",
      "transformations": [
        {
          "id": "labelsToFields",
          "options": {}
        },
        {
          "id": "merge",
          "options": {}
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {},
            "includeByName": {},
            "indexByName": {
              "_time": 0,
              "category": 2,
              "dest_ip": 6,
              "proto": 4,
              "severity": 1,
              "sid": 5,
              "signature": 7,
              "src_ip": 3
            },
            "renameByName": {
              "_time": "Time",
              "category": "Category",
              "dest_ip": "Destination IP",
              "proto": "Protocal ",
              "severity": "Severity",
              "sid": "Signature ID",
              "signature": "Signature",
              "src_ip": "Source IP"
            }
          }
        }
      ],
      "type": "table"
    }
  ],
  "preload": false,
  "schemaVersion": 42,
  "tags": [],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-5m",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "SIEM ",
  "uid": "adl4bcb",
  "version": 71,
  "weekStart": ""
}