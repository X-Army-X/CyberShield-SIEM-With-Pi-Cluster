{"apiVersion":1,"groups":[{"orgId":1,"name":"ids-evaluation","folder":"IDS NODE 1","interval":"1m","rules":[{"uid":"af9zkwxy80iyoa","title":"Alert Count Over Time","condition":"A","data":[{"refId":"A","queryType":"alerting","relativeTimeRange":{"from":172800,"to":0},"datasourceUid":"cf8kclbta7qiob","model":{"datasource":{"type":"influxdb","uid":"cf8kclbta7qiob"},"expression":"","instant":false,"intervalMs":1000,"maxDataPoints":43200,"query":"from(bucket: \"Security_logs\")\r\n  |\u003e range(start: -5m)\r\n  |\u003e filter(fn: (r) =\u003e r._measurement == \"suricata_alerts\")\r\n  |\u003e filter(fn: (r) =\u003e r._field == \"count\")\r\n  |\u003e group()\r\n  |\u003e aggregateWindow(every: 1m, fn: sum, createEmpty: false)\r\n","queryType":"alerting","range":true,"refId":"A"}},{"refId":"B","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[0,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"A","intervalMs":1000,"maxDataPoints":43200,"reducer":"last","refId":"B","settings":{"mode":""},"type":"reduce"}},{"refId":"C","relativeTimeRange":{"from":0,"to":0},"datasourceUid":"__expr__","model":{"conditions":[{"evaluator":{"params":[20,0],"type":"gt"},"operator":{"type":"and"},"query":{"params":[]},"reducer":{"params":[],"type":"avg"},"type":"query"}],"datasource":{"name":"Expression","type":"__expr__","uid":"__expr__"},"expression":"B","intervalMs":1000,"maxDataPoints":43200,"refId":"C","type":"threshold"}},{"refId":"D","relativeTimeRange":{"from":600,"to":0},"datasourceUid":"cf8kclbta7qiob","model":{"datasource":{"type":"influxdb","uid":"cf8kclbta7qiob"},"intervalMs":1000,"maxDataPoints":43200,"refId":"D"}}],"dashboardUid":"adl4bcb","panelId":1,"noDataState":"Alerting","execErrState":"KeepLast","for":"1m","annotations":{"__dashboardUid__":"adl4bcb","__panelId__":"1","description":"Suricata generated an unusually high number of alerts within a short time window.\nThis may indicate scanning activity, misuse, or a potential attack on the monitored network.","runbook_url":"http://localhost:3000","summary":"High IDS Alert Rate Detected"},"labels":{"component":"suricata","severity":"warning"},"isPaused":false,"notification_settings":{"receiver":"Owner"}}]}]}
